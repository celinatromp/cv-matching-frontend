<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>    <title>Trainee Beheer</title>
    <script src="../algemeen.js"></script>
    <script>
        window.onload=function(){
          TekenNavBalk("beheer");
        };
      </script>

  </head>
<<<<<<< HEAD
<style>
#progress-container{
width: 50%; 
background-color: #dddddd;
}
#progress-bar {
width: 0%; 
height: 20px; 
background-color: #05a00a;
transition: ease, 0.5s;

    
}

    


</style>
=======


>>>>>>> 7e89cdb64d9b4ebc30d0ad51d5a53c36a2b5560d
  <body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary" id="navbalk"></nav>

    <h1>Onze trainees</h1>
    <h2>Nieuw trainees toevoegen</h2>
    <form id="createTraineeForm">
        <label for="invoer-voornaam">Voornaam:</label>
        <input type="text" id="invoer-voornaam" name="voornaam" required><br>
    
        <label for="invoer-achternaam">Achternaam:</label>
        <input type="text" id="invoer-achternaam" name="achternaam" required><br>
    
        <label for="invoer-leeftijd">Leeftijd</label>
        <input type="number" id="invoer-leeftijd" name="leeftijd" required><br>
    
        <label for="invoer-woonplaats">Woonplaats:</label>
        <input type="text" id="invoer-woonplaats" name="woonplaats" required><br>
    
        <label for="invoer-specialisatie">Specialisatie:</label>
        <input type="text" id="invoer-specialisatie" name="specialisatie" required><br>
    
        <label for="invoer-bio">Kort Omschrijving:</label>
        <textarea id="invoer-bio" name="bio" required></textarea><br>

        <label for="invoer-bio-long">Uitgebreid Omschrijving:</label>
        <textarea id="invoer-bio-long" name="bio-long" required></textarea><br>
        

    
        <label for="status">Status:</label>
        <select id="status" name="status">
            <option value="Beschikbaar">Beschikbaar</option>
            <option value="Gesprek">In Gesprek</option>
            <option value="Geplaatst">Geplaatst</option>
        </select><br>
    
        <label for="invoer-foto">Foto:</label>
        <input type="file" id="invoer-foto" name="foto" accept="image/*" required><br>
    </form>
    
    <button type="button" onclick="createTrainee()">Opslaan</button>
    
    <br>
    <div id="progress-container" >
        <div id="progress-bar"></div>
      </div>
      <p id="progress-text">Progress: 0%</p>

    <h2>Trainees Updaten</h2>
    <input type="text" id="update-voornaam" placeholder="vul voornaam in">
    <input type="text" id="update-achternaam" placeholder="vul achternaam in">
    <input type="number" id="update-leeftijd" placeholder="vul leeftijd in">
    <input type="text" id="update-woonplaats" placeholder="vul woonplaats in">
    <input type="text" id="update-specialisatie" placeholder="vul uw specialisatie in">
    <input type="text" id="update-bio" placeholder="vul uw bio in">
    <select id="update-status" name="status">
        <option value="Beschikbaar">Beschikbaar</option>
        <option value="Gesprek">In Gesprek</option>
        <option value="Geplaatst">Geplaatst</option>
      </select>
    <input type="text" id="update-traineeId" placeholder="vul een id nummer in">
    <button type="button" onclick="updateTrainee()">Update</button>
    
    
    <h2>Selecteer trainees om te verwijderen</h2>
    <button type="button" onclick="deleteSelectedTrainees()">Delete Selected</button>
  
    <br>
    <h2>Tabel van Trainees</h2>
      <table id="trainee-table">
        <thead>
            <tr>
                <th>Select</th>
                <th>ID</th>
                <th>Voornaam</th>
                <th>Achternaam</th>
                <th>Leeftijd</th>
                <th>Woonplaats</th>
                <th>Specialisatie</th>
                <th>Bio</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
   
    <script>
    function updateProgressBar() {
    const inputFields = document.querySelectorAll('input[id=invoer-voornaam], input[id=invoer-achternaam],input[id=invoer-leeftijd], input[id=invoer-specialistatie],input[id=invoer-woonplaats], input[id=invoer-bio],input[id=invoer-bio-long],input[id=invoer-foto]');
    let filledFields = 0;
    inputFields.forEach(input => {
        if (input.value) filledFields++;
    });
    
    const totalFields = inputFields.length;
    const filledPercentage = Math.round((filledFields / totalFields) * 100);
    
    const progressBar = document.getElementById('progress-bar');
    progressBar.style.width = filledPercentage + '%';
    if(filledPercentage < 100) {
        progressBar.style.backgroundColor = 'orange';
    } else {
        progressBar.style.backgroundColor = '#05a00a'; // Green
    }
    
    const progressText = document.getElementById('progress-text');
    progressText.innerText = `Progress: ${filledPercentage}%`;
}

// Call updateProgressBar function every time any input field changes
document.querySelectorAll('input[type=text], input[type=number], select').forEach(input => {
    input.addEventListener('input', updateProgressBar);
});

// Initial call to set progress on page load (in case some fields are pre-filled)
updateProgressBar();

function deleteSelectedTrainees() {
    let selectedTraineeIds = [];
    document.querySelectorAll('input[type="checkbox"]:checked').forEach(checkbox => {
        selectedTraineeIds.push(checkbox.dataset.traineeId);
    });

    if (selectedTraineeIds.length === 0) {
        alert("Selecteer ten minste één trainee om te verwijderen.");
        return;
    }

    if (!confirm("Weet je zeker dat je de geselecteerde trainees wilt verwijderen?")) {
        return;
    }
    selectedTraineeIds.forEach(traineeId => {
        fetch(ipbackend + `/trainee/${traineeId}/delete`, {
            method: "DELETE",
        })
        .then((res) => {
            res.json();
        })
        .then(() => {
            alert(`Trainee met ID ${traineeId} is succesvol verwijderd!`);
            // Reload data after successful deletion
            loadData();
        })
        .catch((error) => {
            console.error(error.message);
            alert(`Er is een fout opgetreden bij het verwijderen van trainee ${traineeId}. Probeer het opnieuw.`);
        });
    });
}
function updateTrainee() {
    let traineeId = document.getElementById("update-traineeId").value;
    let fieldsToUpdate = {};

    // Check each field for a value and if it's changed, add it to the fieldsToUpdate object
    document.querySelectorAll('#update-voornaam, #update-achternaam, #update-leeftijd, #update-woonplaats, #update-specialisatie, #update-bio, #update-status')
        .forEach(input => {
            // Assuming you've attached an onChange handler to mark fields as changed
            // For simplicity, we'll just check if the field is not empty
            if (input.value) {
                // Use the input id to map to the correct field name in your database or backend
                let fieldName = input.id.replace('update-', '');
                fieldsToUpdate[fieldName] = input.value;
            }
        });

    if (Object.keys(fieldsToUpdate).length === 0) {
        alert("Geen wijzigingen aangebracht.");
        return;
    }

    fetch(ipbackend + `/trainee/${traineeId}/update`, {
        method: "PUT",
        headers: {
            "Content-type": "application/json"
        },
        body: JSON.stringify(fieldsToUpdate)
    })
    .then(res => {
        
      res.json();
    })
    .then(() => {
        alert("Trainee with ID " + traineeId + " was updated!");
        loadData();
    })
};
function createTrainee() {
    // Stap 1 - Verzamelen van data uit de invoer velden
    // Voor de afbeelding wordt FormData gebruikt, dus de JSON structuur wordt hier aangepast
    const formData = new FormData();

    formData.append("voornaam", document.getElementById("invoer-voornaam").value);
    formData.append("achternaam", document.getElementById("invoer-achternaam").value);
    formData.append("leeftijd", document.getElementById("invoer-leeftijd").value);
    formData.append("woonplaats", document.getElementById("invoer-woonplaats").value);
    formData.append("specialisatie", document.getElementById("invoer-specialisatie").value);
    formData.append("bio", document.getElementById("invoer-bio").value);
    formData.append("bio-long", document.getElementById("invoer-bio-long").value);
    formData.append("status", document.getElementById("status").value);
    formData.append("foto", document.getElementById("invoer-foto").value);
    // Voor de foto:
    const fotoInput = document.getElementById("invoer-foto");
    if (fotoInput.files[0]) {
        formData.append("foto", fotoInput.files[0]);
    } else {
        alert("Selecteer a.u.b. een foto.");
        return; // Stop de functie als er geen foto is geselecteerd
    }

    // Stap 2 - Sturen van de nieuwe trainee met foto
    fetch(ipbackend + "/trainee/create", {
        method: "POST",
        body: formData, // FormData object wordt direct gebruikt, geen JSON.stringify
        // Headers zijn niet nodig; de browser zal de juiste Content-Type voor FormData instellen
    })
    .then((res) => {
        if (!res.ok) {
            throw new Error('Netwerk response was niet ok');
        }
        return res.json();
    })
    .then((newTrainee) => {
        alert("Trainee aangemaakt met id: " + newTrainee.id);

        // Stap 3 - Herladen van de tabel
        loadData();
    })
    .catch((error) => {
        console.error('Fout bij het aanmaken van de trainee:', error);
        alert('Er is een fout opgetreden bij het aanmaken van de trainee.');
    });
}


      function loadData() {
    fetch(ipbackend+ "/trainee/all")
        .then((res) => {
            if (!res.ok) {
                throw new Error(`Error fetching trainees: ${res.statusText}`);
            }
            return res.json();
        })
        .then((trainees) => {
            console.log(trainees);
            let traineesHtml = "";
            trainees.forEach((trainee) => {
                traineesHtml += 
                `
                    <tr>
                        <td><input type="checkbox" data-trainee-id="${trainee.id}"></td>
                        <td>${trainee.id}</td>
                        <td>${trainee.voornaam}</td>
                        <td>${trainee.achternaam}</td>
                        <td>${trainee.leeftijd}</td>
                        <td>${trainee.woonplaats}</td>
                        <td>${trainee.specialisatie}</td>
                        <td>${trainee.bio}</td>
                        <td>${trainee.status}</td>
                    </tr>
                `;
            });

            // Check if there are no trainees
            if (trainees.length === 0) {
                // If no trainees, display a single row with colspan to span across all columns
                traineesHtml = `
                    <tr>
                        <td colspan="8">Geen trainees gevonden</td>
                    </tr>
                `;
            }

            // Prepend the table headers to the traineesHtml
            const tableHtml = `
                <thead>
                    <tr>
                        <th>Select</th>
                        <th>ID</th>
                        <th>Voornaam</th>
                        <th>Achternaam</th>
                        <th>Leeftijd</th>
                        <th>Woonplaats</th>
                        <th>Specialisatie</th>
                        <th>Bio</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    ${traineesHtml}
                </tbody>
            `;

            document.getElementById("trainee-table").innerHTML = tableHtml;
        })
        .catch((error) => {
            console.error(error.message);
            alert("Er is een fout opgetreden bij het laden van de trainees. Probeer het opnieuw.");
        });
};
      loadData();
    </script>
  </body>
</html>